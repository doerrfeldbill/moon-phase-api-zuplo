{
  "openapi": "3.1.0",
  "info": {
    "title": "Moon Phase API (Sample)",
    "version": "1.0.0",
    "description": "Sample Zuplo API you can deploy from Git and monetize with API keys + plans."
  },
  "paths": {
    "/health": {
      "get": {
        "summary": "Health check",
        "operationId": "health",
        "x-zuplo-route": {
          "corsPolicy": "none",
          "handler": {
            "export": "health",
            "module": "$import(./modules/moon-phase)"
          },
          "policies": { "inbound": [] }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },

    "/openapi": {
      "get": {
        "summary": "Public OpenAPI spec (Zuplo strips x-zuplo-*)",
        "operationId": "openapi",
        "x-zuplo-route": {
          "corsPolicy": "none",
          "handler": {
            "export": "openApiSpecHandler",
            "module": "$import(@zuplo/runtime)",
            "options": {
              "openApiFile": "./config/routes.oas.json"
            }
          },
          "policies": { "inbound": [] }
        },
        "responses": {
          "200": { "description": "OpenAPI JSON" }
        }
      }
    },

    "/v1/moon-phase": {
      "get": {
        "summary": "Get moon phase for a date (YYYY-MM-DD). Defaults to today.",
        "operationId": "getMoonPhase",
        "parameters": [
          {
            "name": "date",
            "in": "query",
            "required": false,
            "schema": { "type": "string", "example": "2026-03-06" }
          }
        ],
        "x-zuplo-route": {
          "corsPolicy": "none",
          "handler": {
            "export": "getMoonPhase",
            "module": "$import(./modules/moon-phase)"
          },
          "policies": {
            "inbound": ["api-key-auth", "rate-limit-per-user"]
          }
        },
        "responses": {
          "200": { "description": "Moon phase result" },
          "400": { "description": "Bad request" },
          "401": { "description": "Unauthorized" },
          "429": { "description": "Too many requests" }
        }
      }
    },

    "/v1/moon-phase/today": {
      "get": {
        "summary": "Get moon phase for today",
        "operationId": "getMoonPhaseToday",
        "x-zuplo-route": {
          "corsPolicy": "none",
          "handler": {
            "export": "getMoonPhaseToday",
            "module": "$import(./modules/moon-phase)"
          },
          "policies": {
            "inbound": ["api-key-auth", "rate-limit-per-user"]
          }
        },
        "responses": {
          "200": { "description": "Moon phase result" }
        }
      }
    },

    "/v1/moon-phase/{date}": {
      "get": {
        "summary": "Get moon phase for a path date (YYYY-MM-DD)",
        "operationId": "getMoonPhaseByPath",
        "parameters": [
          {
            "name": "date",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "example": "2026-03-06" }
          }
        ],
        "x-zuplo-route": {
          "corsPolicy": "none",
          "handler": {
            "export": "getMoonPhaseByPath",
            "module": "$import(./modules/moon-phase)"
          },
          "policies": {
            "inbound": ["api-key-auth", "rate-limit-per-user"]
          }
        },
        "responses": {
          "200": { "description": "Moon phase result" },
          "400": { "description": "Bad request" }
        }
      }
    },

    "/v1/moon-calendar": {
      "get": {
        "summary": "Get moon phases for an entire month (YYYY-MM). Defaults to current month.",
        "operationId": "getMoonCalendar",
        "parameters": [
          {
            "name": "month",
            "in": "query",
            "required": false,
            "schema": { "type": "string", "example": "2026-03" }
          }
        ],
        "x-zuplo-route": {
          "corsPolicy": "none",
          "handler": {
            "export": "getMoonCalendar",
            "module": "$import(./modules/moon-phase)"
          },
          "policies": {
            "inbound": ["api-key-auth", "rate-limit-per-user"]
          }
        },
        "responses": {
          "200": { "description": "Month calendar" }
        }
      }
    }
  }
}
